# Requirements Archive: v1.1 Cast Media Playback

**Archived:** 2026-01-18
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.1.
For current requirements, see `.planning/REQUIREMENTS.md` (will be created for next milestone).

---

# Requirements: Dashboard Cast Service v1.1

**Defined:** 2026-01-17
**Core Value:** Complete the Cast playback pipeline with dual-mode streaming for both dashboard reliability and camera feed low-latency.

## v1.1 Requirements

Requirements for v1.1 Cast Media Playback milestone. Each maps to roadmap phases.

### HTTP Streaming

- [x] **STRM-01**: HTTP endpoints serve video streams to Cast device via FastAPI — **VALIDATED v1.1** (Phase 6)
- [x] **STRM-02**: Service supports dual-mode streaming: HLS (buffered) and fMP4 (low-latency) — **VALIDATED v1.1** (Phases 6, 7)
- [x] **STRM-03**: Per-request mode selection via webhook `mode` parameter — **VALIDATED v1.1** (Phase 7)
- [x] **STRM-04**: HLS playlists served with `application/vnd.apple.mpegurl` content type — **VALIDATED v1.1** (Phase 6)
- [x] **STRM-05**: Video segments served with proper MIME types (video/MP2T, video/mp4) — **VALIDATED v1.1** (Phase 6)
- [x] **STRM-06**: CORS headers configured for Cast device access — **VALIDATED v1.1** (Phase 6)

### Cast Playback

- [x] **CAST-01**: `media_controller.play_media()` displays HTTP stream on TV — **VALIDATED v1.1** (Phase 8)
- [x] **CAST-02**: Correct `stream_type` parameter used (BUFFERED for HLS, LIVE for fMP4) — **VALIDATED v1.1** (Phase 8)
- [x] **CAST-03**: Correct `content_type` passed to play_media based on mode — **VALIDATED v1.1** (Phase 8)

### Network Configuration

- [x] **NET-01**: Auto-detect host IP for Cast-accessible stream URL — **VALIDATED v1.1** (Phase 6)
- [x] **NET-02**: Stream URL accessible from Cast device's network — **VALIDATED v1.1** (Phase 6)

### FFmpeg Pipeline

- [x] **ENC-01**: HLS output mode generates MPEG-TS segments with playlist — **VALIDATED v1.1** (Phase 7)
- [x] **ENC-02**: fMP4 output mode generates fragmented MP4 stream — **VALIDATED v1.1** (Phase 7)
- [x] **ENC-03**: H.264 High Profile Level 4.1 for universal Cast compatibility — **VALIDATED v1.1** (Phase 7)
- [x] **ENC-04**: AAC audio encoding for Cast compatibility — **VALIDATED v1.1** (Phase 7)

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Network Configuration

- **NET-03**: `STREAM_HOST_IP` env var for manual override — **Partially implemented** (env var exists, used in docker-compose.yml)
- **NET-04**: `STREAM_PORT` env var for separate streaming port — **Not implemented** (hardcoded to 8080)

### FFmpeg Pipeline

- **ENC-05**: Configurable keyframe interval per mode — **Not implemented**
- **ENC-06**: Mode-specific FFmpeg presets (veryfast for HLS, ultrafast for fMP4) — **Not implemented**

### Cast Playback

- **CAST-04**: Mode-specific stream configuration (different settings for dashboard vs camera) — **Not implemented**

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Custom Cast receiver app | High complexity, default media receiver works for v1.1 |
| Adaptive bitrate streaming | Single quality per stream sufficient for v1.1 |
| DASH manifest support | HLS and direct fMP4 cover all use cases |
| Hardware encoding (NVENC/VAAPI) | Deferred to v2, software encoding works everywhere |
| Multiple simultaneous streams | Single stream target for v1.1 |

## Traceability

Which phases cover which requirements. Final status.

| Requirement | Phase | Status |
|-------------|-------|--------|
| STRM-01 | Phase 6 | ✅ Complete |
| STRM-02 | Phase 6 | ✅ Complete |
| STRM-03 | Phase 7 | ✅ Complete |
| STRM-04 | Phase 6 | ✅ Complete |
| STRM-05 | Phase 6 | ✅ Complete |
| STRM-06 | Phase 6 | ✅ Complete |
| CAST-01 | Phase 8 | ✅ Complete |
| CAST-02 | Phase 8 | ✅ Complete |
| CAST-03 | Phase 8 | ✅ Complete |
| NET-01 | Phase 6 | ✅ Complete |
| NET-02 | Phase 6 | ✅ Complete |
| ENC-01 | Phase 7 | ✅ Complete |
| ENC-02 | Phase 7 | ✅ Complete |
| ENC-03 | Phase 7 | ✅ Complete |
| ENC-04 | Phase 7 | ✅ Complete |

**Coverage:**
- v1.1 requirements: 15 total
- Mapped to phases: 15 ✓
- Unmapped: 0
- **SHIPPED: 15/15 (100%)**

---

## Milestone Summary

**Shipped:** 15 of 15 v1.1 requirements (100%)

**Adjusted:** None — all requirements delivered as specified

**Dropped:** None

**Technical Debt:**
- HLS stream freezes after 6 seconds (buffering configuration tuning needed)
  - Not a requirements gap, but a quality/performance issue
  - Documented for future improvement

**Implementation Notes:**
- NET-03 (STREAM_HOST_IP env var) was partially implemented — the env var exists and is used in docker-compose.yml, though manual override capability exceeds the requirement
- All other requirements delivered exactly as specified

---
*Archived: 2026-01-18 as part of v1.1 milestone completion*
